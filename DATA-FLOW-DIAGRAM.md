# ğŸ”„ Diagrama de Fluxo de Dados - Sistemaws

## ğŸ“Š Fluxo Completo de Dados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸŒ FRONTEND (Angular)                              â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   Login Form    â”‚    â”‚  User List      â”‚    â”‚  Create User    â”‚            â”‚
â”‚  â”‚                 â”‚    â”‚  Component      â”‚    â”‚  Component      â”‚            â”‚
â”‚  â”‚ Email: string   â”‚    â”‚                 â”‚    â”‚                 â”‚            â”‚
â”‚  â”‚ Password: stringâ”‚    â”‚ Display users   â”‚    â”‚ Form validation â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                       â”‚                       â”‚                   â”‚
â”‚           â–¼                       â–¼                       â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ğŸ”§ AuthService                                      â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  authenticate(email, password) â†’ POST /api/auth/authenticate               â”‚ â”‚
â”‚  â”‚  getUsers() â†’ GET /api/users (with JWT token)                             â”‚ â”‚
â”‚  â”‚  createUser(userData) â†’ POST /api/users (with JWT token)                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ HTTP Requests
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â˜ï¸ AZURE FUNCTIONS (API)                               â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Authenticate    â”‚    â”‚   GetUsers      â”‚    â”‚  CreateUser     â”‚            â”‚
â”‚  â”‚ Function        â”‚    â”‚   Function      â”‚    â”‚  Function       â”‚            â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚            â”‚
â”‚  â”‚ [HttpTrigger]   â”‚    â”‚ [HttpTrigger]   â”‚    â”‚ [HttpTrigger]   â”‚            â”‚
â”‚  â”‚ POST /auth/     â”‚    â”‚ GET /users      â”‚    â”‚ POST /users     â”‚            â”‚
â”‚  â”‚ authenticate    â”‚    â”‚                 â”‚    â”‚                 â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                       â”‚                       â”‚                   â”‚
â”‚           â–¼                       â–¼                       â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    ğŸ›¡ï¸ JWT AUTHENTICATION MIDDLEWARE                        â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  â€¢ Validates JWT tokens                                                    â”‚ â”‚
â”‚  â”‚  â€¢ Extracts user information                                               â”‚ â”‚
â”‚  â”‚  â€¢ Skips authentication for public endpoints                               â”‚ â”‚
â”‚  â”‚  â€¢ Returns 401 for invalid/missing tokens                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ MediatR Commands/Queries
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ§  APPLICATION LAYER (CQRS)                           â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           ğŸ“ COMMANDS                                       â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  AuthenticateCommand {                    CreateUserCommand {               â”‚ â”‚
â”‚  â”‚    Email: string                            Name: string                    â”‚ â”‚
â”‚  â”‚    Password: string                         Email: string                   â”‚ â”‚
â”‚  â”‚  }                                          Password: string                â”‚ â”‚
â”‚  â”‚                                             }                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                                         â”‚                         â”‚
â”‚           â–¼                                         â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          âš¡ HANDLERS                                       â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  AuthenticateCommandHandler {              CreateUserCommandHandler {      â”‚ â”‚
â”‚  â”‚    1. Validate credentials                 1. Check if user is admin       â”‚ â”‚
â”‚  â”‚    2. Generate JWT token                   2. Validate user data           â”‚ â”‚
â”‚  â”‚    3. Return token + user data             3. Hash password                â”‚ â”‚
â”‚  â”‚  }                                         4. Save to database             â”‚ â”‚
â”‚  â”‚                                            }                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           ğŸ” QUERIES                                       â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  GetAllUsersQuery {                    GetUserByIdQuery {                   â”‚ â”‚
â”‚  â”‚    // No parameters                      Id: int                           â”‚ â”‚
â”‚  â”‚  }                                       }                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                                         â”‚                         â”‚
â”‚           â–¼                                         â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          âš¡ HANDLERS                                       â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  GetAllUsersQueryHandler {              GetUserByIdQueryHandler {           â”‚ â”‚
â”‚  â”‚    1. Get all users from repo           1. Get user by ID from repo        â”‚ â”‚
â”‚  â”‚    2. Return user list                  2. Return user data               â”‚ â”‚
â”‚  â”‚  }                                       }                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Repository Calls
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ğŸ›ï¸ DOMAIN LAYER (Core)                                â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           ğŸ—ï¸ ENTITIES                                      â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  User {                                                                     â”‚ â”‚
â”‚  â”‚    Id: int                                                                  â”‚ â”‚
â”‚  â”‚    Name: string                                                             â”‚ â”‚
â”‚  â”‚    Email: string                                                            â”‚ â”‚
â”‚  â”‚    PasswordHash: string                                                     â”‚ â”‚
â”‚  â”‚    Salt: string                                                             â”‚ â”‚
â”‚  â”‚    IsActive: bool                                                           â”‚ â”‚
â”‚  â”‚    IsAdministrator: bool                                                   â”‚ â”‚
â”‚  â”‚    CreatedAt: DateTime                                                     â”‚ â”‚
â”‚  â”‚    UpdatedAt: DateTime?                                                    â”‚ â”‚
â”‚  â”‚  }                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           ğŸ“‹ DTOs                                          â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  CreateUserRequest {                   LoginRequest {                       â”‚ â”‚
â”‚  â”‚    Name: string                            Email: string                    â”‚ â”‚
â”‚  â”‚    Email: string                           Password: string                 â”‚ â”‚
â”‚  â”‚    Password: string                      }                                 â”‚ â”‚
â”‚  â”‚  }                                                                          â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  UserResponse {                        LoginResponse {                      â”‚ â”‚
â”‚  â”‚    Id: int                                 Token: string                    â”‚ â”‚
â”‚  â”‚    Name: string                            User: UserResponse               â”‚ â”‚
â”‚  â”‚    Email: string                         }                                 â”‚ â”‚
â”‚  â”‚    IsActive: bool                                                          â”‚ â”‚
â”‚  â”‚    IsAdministrator: bool                                                  â”‚ â”‚
â”‚  â”‚    CreatedAt: DateTime                                                    â”‚ â”‚
â”‚  â”‚  }                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Repository Implementation
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ”§ INFRASTRUCTURE LAYER                                  â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ğŸ“š REPOSITORIES                                     â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  UserRepository : IUserRepository {                                        â”‚ â”‚
â”‚  â”‚    GetByEmail(email) â†’ User                                                â”‚ â”‚
â”‚  â”‚    GetById(id) â†’ User                                                      â”‚ â”‚
â”‚  â”‚    GetAll() â†’ List<User>                                                   â”‚ â”‚
â”‚  â”‚    Create(user) â†’ User                                                     â”‚ â”‚
â”‚  â”‚    Update(user) â†’ User                                                     â”‚ â”‚
â”‚  â”‚    Delete(id) â†’ void                                                       â”‚ â”‚
â”‚  â”‚  }                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ğŸ”§ SERVICES                                         â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  AuthenticationService {                   JwtService {                     â”‚ â”‚
â”‚  â”‚    ValidateCredentials(email, password)     GenerateToken(user)             â”‚ â”‚
â”‚  â”‚    HashPassword(password, salt)             ValidateToken(token)            â”‚ â”‚
â”‚  â”‚  }                                          ExtractUserInfo(token)          â”‚ â”‚
â”‚  â”‚                                            }                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ğŸ’¾ PERSISTENCE                                     â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  SistemawsDbContext : DbContext {                                           â”‚ â”‚
â”‚  â”‚    DbSet<User> Users                                                        â”‚ â”‚
â”‚  â”‚    OnModelCreating() â†’ Configure entities                                   â”‚ â”‚
â”‚  â”‚  }                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ SQL Queries
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ—„ï¸ SQL SERVER DATABASE                               â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                              Users Table                                   â”‚ â”‚
â”‚  â”‚                                                                             â”‚ â”‚
â”‚  â”‚  CREATE TABLE [Users] (                                                    â”‚ â”‚
â”‚  â”‚    [Id] int NOT NULL IDENTITY,                                             â”‚ â”‚
â”‚  â”‚    [Name] nvarchar(100) NOT NULL,                                          â”‚ â”‚
â”‚  â”‚    [Email] nvarchar(255) NOT NULL,                                        â”‚ â”‚
â”‚  â”‚    [PasswordHash] nvarchar(max) NOT NULL,                                  â”‚ â”‚
â”‚  â”‚    [Salt] nvarchar(max) NOT NULL,                                          â”‚ â”‚
â”‚  â”‚    [IsActive] bit NOT NULL,                                                â”‚ â”‚
â”‚  â”‚    [IsAdministrator] bit NOT NULL,                                         â”‚ â”‚
â”‚  â”‚    [Deleted] bit NOT NULL DEFAULT CAST(0 AS bit),                         â”‚ â”‚
â”‚  â”‚    [CreatedBy] int NULL,                                                   â”‚ â”‚
â”‚  â”‚    [CreatedAt] datetime2 NOT NULL,                                         â”‚ â”‚
â”‚  â”‚    [UpdatedBy] int NULL,                                                   â”‚ â”‚
â”‚  â”‚    [UpdatedAt] datetime2 NULL,                                             â”‚ â”‚
â”‚  â”‚    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])                                â”‚ â”‚
â”‚  â”‚  );                                                                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Fluxos EspecÃ­ficos

### **1. ğŸ” Fluxo de AutenticaÃ§Ã£o**

```
Frontend â†’ AuthenticateFunction â†’ AuthenticateCommand â†’ AuthenticateCommandHandler
    â†“              â†“                      â†“                        â†“
Login Form    [HttpTrigger]         Email + Password        Validate Credentials
    â†“              â†“                      â†“                        â†“
HTTP POST â†’ Middleware Skip â†’ MediatR Send â†’ UserRepository.GetByEmail()
    â†“              â†“                      â†“                        â†“
JSON Body â†’ Function Execute â†’ Handler Process â†’ Database Query
    â†“              â†“                      â†“                        â†“
Response â† JWT Token â† Password Check â† User Entity â† SQL Result
```

### **2. ğŸ‘¥ Fluxo de CriaÃ§Ã£o de UsuÃ¡rio**

```
Frontend â†’ CreateUserFunction â†’ CreateUserCommand â†’ CreateUserCommandHandler
    â†“              â†“                    â†“                      â†“
User Form    [HttpTrigger]         User Data            Check Admin Role
    â†“              â†“                    â†“                      â†“
HTTP POST â†’ Middleware Auth â†’ MediatR Send â†’ Validate Admin Token
    â†“              â†“                    â†“                      â†“
JSON Body â†’ JWT Validation â†’ Handler Process â†’ UserRepository.Create()
    â†“              â†“                    â†“                      â†“
Response â† User Created â† Password Hash â† Database Insert â† SQL Execute
```

### **3. ğŸ“‹ Fluxo de Listagem de UsuÃ¡rios**

```
Frontend â†’ GetUsersFunction â†’ GetAllUsersQuery â†’ GetAllUsersQueryHandler
    â†“              â†“                 â†“                    â†“
User List    [HttpTrigger]      No Parameters        Get All Users
    â†“              â†“                 â†“                    â†“
HTTP GET â†’ Middleware Auth â†’ MediatR Send â†’ UserRepository.GetAll()
    â†“              â†“                 â†“                    â†“
JSON Body â†’ JWT Validation â†’ Handler Process â†’ Database Query
    â†“              â†“                 â†“                    â†“
Response â† User List â† Map to DTOs â† User Entities â† SQL Result
```

## ğŸ“Š Resumo dos Fluxos

| OperaÃ§Ã£o | Endpoint | MÃ©todo | AutenticaÃ§Ã£o | AutorizaÃ§Ã£o | Fluxo |
|----------|----------|--------|--------------|-------------|-------|
| **Login** | `/api/auth/authenticate` | POST | âŒ NÃ£o | âŒ NÃ£o | Frontend â†’ Function â†’ Command â†’ Handler â†’ Repository â†’ Database |
| **Listar UsuÃ¡rios** | `/api/users` | GET | âœ… Sim | âŒ NÃ£o | Frontend â†’ Function â†’ Query â†’ Handler â†’ Repository â†’ Database |
| **Criar UsuÃ¡rio** | `/api/users` | POST | âœ… Sim | âœ… Admin | Frontend â†’ Function â†’ Command â†’ Handler â†’ Repository â†’ Database |
| **Buscar UsuÃ¡rio** | `/api/users/{id}` | GET | âœ… Sim | âŒ NÃ£o | Frontend â†’ Function â†’ Query â†’ Handler â†’ Repository â†’ Database |

## ğŸ¯ Pontos de ValidaÃ§Ã£o

1. **ğŸŒ Frontend**: ValidaÃ§Ã£o de formulÃ¡rios, formato de dados
2. **â˜ï¸ Azure Functions**: Middleware de autenticaÃ§Ã£o, validaÃ§Ã£o de headers
3. **ğŸ§  Application**: FluentValidation, regras de negÃ³cio
4. **ğŸ›ï¸ Domain**: ValidaÃ§Ã£o de entidades, regras de domÃ­nio
5. **ğŸ”§ Infrastructure**: ValidaÃ§Ã£o de dados de entrada, sanitizaÃ§Ã£o
6. **ğŸ—„ï¸ Database**: Constraints, Ã­ndices Ãºnicos, integridade referencial
